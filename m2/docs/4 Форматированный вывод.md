# Форматированный вывод

## Основные спецификаторы format()

```sql
-- %s - строка (основной спецификатор)
SELECT format('Привет %s', 'Мир') AS greeting;
-- Результат: Привет Мир

-- %% - литеральный символ %
SELECT format('Тестирование %s, %s, %s, %%', 'один', 'два', 'три') AS test;
-- Результат: Тестирование один, два, три, %

-- %n$s - позиционные параметры (можно менять порядок)
SELECT format('Testing %3$s, %2$s, %1$s', 'one', 'two', 'three') AS reordered;
-- Результат: Testing three, two, one

-- %I - идентификатор SQL (автоматическое экранирование)
SELECT format('INSERT INTO %I VALUES(%L)', 'Foo bar', E'O\'Reilly') AS sql_safe;
-- Результат: INSERT INTO "Foo bar" VALUES('O''Reilly')

-- %L - литерал SQL (безопасное экранирование строк)
SELECT format('INSERT INTO %I VALUES(%L)', 'locations', 'C:\Program Files') AS safe_path;
-- Результат: INSERT INTO locations VALUES('C:\Program Files')

```

## Числовые спецификаторы

```sql
-- %d - целое число
SELECT format('Количество: %d', 42) AS count_msg;
-- Результат: Количество: 42

-- %f - число с плавающей точкой
SELECT format('Цена: %.2f руб.', 123.456) AS price;
-- Результат: Цена: 123.46 руб.

-- %e - научная нотация
SELECT format('Научная нотация: %e', 1234567.89) AS scientific;
-- Результат: Научная нотация: 1.234568e+06

```

## Практические примеры

```sql
-- Создание динамических SQL запросов
SELECT format('SELECT * FROM %I WHERE %I = %L', 'users', 'name', 'John') AS dynamic_sql;
-- Результат: SELECT * FROM users WHERE name = 'John'

-- Форматирование отчетов
SELECT 
    name,
    format('Пользователь: %s (возраст: %d лет)', name, age) AS user_info
FROM (VALUES 
    ('Alice', 25),
    ('Bob', 30),
    ('Charlie', 35)
) AS users(name, age);

-- Форматирование JSON
SELECT format('{"name": %L, "age": %d, "active": %s}', 'John', 25, 'true') AS json_data;
-- Результат: {"name": 'John', "age": 25, "active": true}

-- Форматирование с выравниванием
SELECT format('%-10s | %5d | %8.2f', name, quantity, price) AS formatted_row
FROM (VALUES 
    ('Apple', 10, 1.50),
    ('Banana', 25, 0.75),
    ('Orange', 8, 2.25)
) AS products(name, quantity, price);

```

## Сравнение с другими функциями

```sql
-- Обычная конкатенация
SELECT 'Hello ' || 'World' || '!' AS simple_concat;

-- Использование concat()
SELECT concat('Hello ', 'World', '!') AS concat_func;

-- Использование format() - более гибко
SELECT format('%s %s%s', 'Hello', 'World', '!') AS format_func;

-- format() полезен для сложного форматирования
SELECT format('Отчет за %2$s: продажи %1$.2f, прибыль %3$.1f%%', 
              125000.50, 'январь', 15.7) AS complex_report;

```