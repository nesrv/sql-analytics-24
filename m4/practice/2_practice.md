# –ö–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –≤–∏–¥–∞ 

"SUM (*) / AVG (*) / MIN(*) / MAX(*) OVER (PARTITION BY * ORDER BY)"


## üîß –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞: —Ç–∞–±–ª–∏—Ü–∞ –ø—Ä–æ–¥–∞–∂

```sql
CREATE TABLE sales (
    id SERIAL PRIMARY KEY,
    seller TEXT,
    sale_date DATE,
    amount NUMERIC
);

INSERT INTO sales (seller, sale_date, amount) VALUES
('Alice', '2024-01-01', 100),
('Alice', '2024-01-03', 200),
('Alice', '2024-01-05', 300),
('Bob',   '2024-01-02', 150),
('Bob',   '2024-01-04', 350),
('Bob',   '2024-01-06', 100);
```

---

## ‚úÖ –ó–ê–î–ê–ß–ê 1: –ü–æ—Å—á–∏—Ç–∞—Ç—å –Ω–∞–∫–æ–ø–∏—Ç–µ–ª—å–Ω—ã–π –∏—Ç–æ–≥ –ø—Ä–æ–¥–∞–∂ –ø–æ –∫–∞–∂–¥–æ–º—É –ø—Ä–æ–¥–∞–≤—Ü—É

**–¶–µ–ª—å:** –ù–∞–∫–∞–ø–ª–∏–≤–∞—é—â–µ–µ `SUM()` –ø–æ –¥–∞—Ç–µ.

```sql
SELECT
    seller,
    sale_date,
    amount,
   ...
FROM sales;

```

üìå `ROWS BETWEEN` —É–∫–∞–∑—ã–≤–∞–µ—Ç, —á—Ç–æ —Å—É–º–º–∞ –∏–¥—ë—Ç "—Å –Ω–∞—á–∞–ª–∞ –¥–æ —Ç–µ–∫—É—â–µ–π —Å—Ç—Ä–æ–∫–∏".

---

## ‚úÖ –ó–ê–î–ê–ß–ê 2: –°—Ä–µ–¥–Ω—è—è —Å—É–º–º–∞ –ø—Ä–æ–¥–∞–∂ –¥–æ –∫–∞–∂–¥–æ–π –¥–∞—Ç—ã –≤–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ

**–¶–µ–ª—å:** –ù–∞–∫–æ–ø–∏—Ç–µ–ª—å–Ω–∞—è `AVG()` ‚Äî —Å—Ä–µ–¥–Ω–∏–π —á–µ–∫ —Å–æ –≤—Ä–µ–º–µ–Ω–µ–º.

```sql

SELECT
    seller,
    sale_date,
    amount,
   ...
FROM sales;
```

---

## ‚úÖ –ó–ê–î–ê–ß–ê 3: –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å—É–º–º–∞ –ø—Ä–æ–¥–∞–∂–∏ **–¥–æ —Ç–µ–∫—É—â–µ–π –¥–∞—Ç—ã**

```sql


SELECT
    seller,
    sale_date,
    amount,
  ...
FROM sales;

```

---

## ‚úÖ –ó–ê–î–ê–ß–ê 4: –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ–¥–∞–∂–∞ **–≤–ø–ª–æ—Ç—å –¥–æ —Ç–µ–∫—É—â–µ–π —Å—Ç—Ä–æ–∫–∏**

```sql

SELECT
    seller,
    sale_date,
    amount,
    ...
FROM sales;

```

---

## ‚úÖ –ó–ê–î–ê–ß–ê 5: –ü–æ—Å—á–∏—Ç–∞—Ç—å –ø—Ä–∏—Ä–æ—Å—Ç –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π –ø—Ä–æ–¥–∞–∂–µ–π

```sql
SELECT
    seller,
    sale_date,
    amount,
    ...
FROM sales;

```


## ‚úÖ –ó–ê–î–ê–ß–ê 6: –ü—Ä–æ—Ü–µ–Ω—Ç —Ç–µ–∫—É—â–µ–π –ø—Ä–æ–¥–∞–∂–∏ –æ—Ç –Ω–∞–∫–æ–ø–∏—Ç–µ–ª—å–Ω–æ–π —Å—É–º–º—ã

```sql
SELECT
    seller,
    sale_date,
    amount,
    ...     AS percent_of_running_total
FROM sales;


SELECT
    seller,
    sale_date,
    amount,
    ... AS percent_of_running_total
FROM sales;


```

---

## üß† –ó–∞–¥–∞—á–∏:

* –í—ã–≤–µ—Å—Ç–∏ —Å–¥–µ–ª–∫–∏, —É –∫–æ—Ç–æ—Ä—ã—Ö —Å—É–º–º–∞ –≤—ã—à–µ –Ω–∞–∫–æ–ø–∏—Ç–µ–ª—å–Ω–æ–≥–æ —Å—Ä–µ–¥–Ω–µ–≥–æ.
* –ü–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ –¥–Ω–∏, –∫–æ–≥–¥–∞ —Ç–µ–∫—É—â–∞—è —Å—É–º–º–∞ —Ä–∞–≤–Ω–∞ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –≤ –æ–∫–Ω–µ.
* –†–∞—Å—Å—á–∏—Ç–∞—Ç—å "—Ä–∞–∑–Ω–∏—Ü—É –º–µ–∂–¥—É —Ç–µ–∫—É—â–µ–π –∏ —Å—Ä–µ–¥–Ω–µ–π –ø—Ä–æ–¥–∞–∂–µ–π –¥–æ —ç—Ç–æ–π –¥–∞—Ç—ã".

