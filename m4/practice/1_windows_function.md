## –ü—Ä–∞–∫—Ç–∏–∫–∞ –æ–∫–æ–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ PostgreSQL:

`LEAD()`, `LAG()`, `FIRST_VALUE()`, `LAST_VALUE()`, `RANK()`, `DENSE_RANK()`, `ROW_NUMBER()`.

## üóÇÔ∏è –ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:

–°–æ–∑–¥–∞–¥–∏–º —Ç–∞–±–ª–∏—Ü—É –ø—Ä–æ–¥–∞–∂:

```sql
CREATE TABLE sales (
    id SERIAL PRIMARY KEY,
    seller TEXT,
    sale_date DATE,
    amount NUMERIC
);

INSERT INTO sales (seller, sale_date, amount) VALUES
('–î–º–∏—Ç—Ä–∏–π', '2024-01-01', 100),
('–î–º–∏—Ç—Ä–∏–π', '2024-01-05', 200),
('–î–º–∏—Ç—Ä–∏–π', '2024-01-10', 300),
('–ö–∞—Ç–µ—Ä–∏–Ω–∞',   '2024-01-02', 400),
('–ö–∞—Ç–µ—Ä–∏–Ω–∞',   '2024-01-07', 100),
('–ö–∞—Ç–µ—Ä–∏–Ω–∞',   '2024-01-08', 600),
('–û–ª–µ–≥', '2024-01-03', 300),
('–û–ª–µ–≥', '2024-01-10', 300),
('–û–ª–µ–≥', '2024-01-12', 300);
```

---

## 1Ô∏è‚É£ **`LAG()`** ‚Äî –ü—Ä–æ–¥–∞–∂–∏ –∏ —Ä–∞–∑–Ω–∏—Ü–∞ —Å –ø—Ä–µ–¥—ã–¥—É—â–µ–π

### üìå –ó–∞–¥–∞—á–∞: –ü–æ–∫–∞–∑–∞—Ç—å —Ä–∞–∑–Ω–∏—Ü—É –º–µ–∂–¥—É —Ç–µ–∫—É—â–µ–π –∏ –ø—Ä–µ–¥—ã–¥—É—â–µ–π –ø—Ä–æ–¥–∞–∂–µ–π –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø—Ä–æ–¥–∞–≤—Ü–∞.

```sql
SELECT
    seller,
    sale_date,
    amount,
    ...
FROM sales;
```

---

## 2Ô∏è‚É£ **`LEAD()`** ‚Äî –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ —Å–ª–µ–¥—É—é—â–µ–π —Å—É–º–º—ã

### üìå –ó–∞–¥–∞—á–∞: –ü–æ—Å—á–∏—Ç–∞—Ç—å, —Å–∫–æ–ª—å–∫–æ –∑–∞—Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–æ–¥–∞–≤–µ—Ü –≤ —Å–ª–µ–¥—É—é—â–µ–π —Å–¥–µ–ª–∫–µ.

```sql
SELECT
    seller,
    sale_date,
    amount,
    ...
FROM sales;
```

---

## 3Ô∏è‚É£ **`FIRST_VALUE()`** ‚Äî –ü–µ—Ä–≤–∞—è –ø—Ä–æ–¥–∞–∂–∞ –ø—Ä–æ–¥–∞–≤—Ü–∞

```sql
SELECT
    seller,
    sale_date,
    amount,
    ...
FROM sales;
```

---

## 4Ô∏è‚É£ **`LAST_VALUE()`** ‚Äî –ü–æ—Å–ª–µ–¥–Ω—è—è –ø—Ä–æ–¥–∞–∂–∞ (–≤ –ø—Ä–µ–¥–µ–ª–∞—Ö –æ–∫–Ω–∞)

‚ö†Ô∏è `LAST_VALUE()` –º–æ–∂–µ—Ç –≤–µ—Ä–Ω—É—Ç—å "–Ω–µ–æ–∂–∏–¥–∞–Ω–Ω—ã–π" —Ä–µ–∑—É–ª—å—Ç–∞—Ç –±–µ–∑ `RANGE BETWEEN ...`.

```sql
SELECT
    seller,
    sale_date,
    amount,
    ...
FROM sales;





```

---

## 5Ô∏è‚É£ **`ROW_NUMBER()`** ‚Äî –ù—É–º–µ—Ä–∞—Ü–∏—è —Å–¥–µ–ª–æ–∫ –ø–æ –¥–∞—Ç–µ

```sql
SELECT
    seller,
    sale_date,
    amount,
    ...
FROM sales;
```

---

## 6Ô∏è‚É£ **`RANK()`** ‚Äî –†–µ–π—Ç–∏–Ω–≥ –ø—Ä–æ–¥–∞–≤—Ü–æ–≤ –ø–æ –ø—Ä–æ–¥–∞–∂–∞–º (—Å –ø—Ä–æ–ø—É—Å–∫–∞–º–∏)

```sql
SELECT
    seller,
    amount,
   ...
FROM sales;
```

---

## 7Ô∏è‚É£ **`DENSE_RANK()`** ‚Äî –¢–æ—Ç –∂–µ —Ä–µ–π—Ç–∏–Ω–≥, –Ω–æ –±–µ–∑ –ø—Ä–æ–ø—É—Å–∫–æ–≤

```sql
SELECT
    seller,
    amount,
    ...
FROM sales;
```

### üìå –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –∑–∞–¥–∞–Ω–∏—è:

1. **–ù–∞–π—Ç–∏ –¥–∞—Ç—É —Å–∞–º–æ–π –ø–µ—Ä–≤–æ–π –∏ –ø–æ—Å–ª–µ–¥–Ω–µ–π –ø—Ä–æ–¥–∞–∂–∏ –∫–∞–∂–¥–æ–≥–æ –ø—Ä–æ–¥–∞–≤—Ü–∞.**
2. **–ü–æ–∫–∞–∑–∞—Ç—å —Å–¥–µ–ª–∫–∏, –≥–¥–µ —Ä–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É —Ç–µ–∫—É—â–µ–π –∏ –ø—Ä–µ–¥—ã–¥—É—â–µ–π –ø—Ä–æ–¥–∞–∂–µ–π –ø—Ä–µ–≤—ã—à–∞–µ—Ç 200.**
3. **–ü–æ–∫–∞–∑–∞—Ç—å —Ç–æ–ø-1 –ø—Ä–æ–¥–∞–∂—É –∫–∞–∂–¥–æ–≥–æ –ø—Ä–æ–¥–∞–≤—Ü–∞ (–ø–æ —Å—É–º–º–µ) —Å `RANK()` –∏ `ROW_NUMBER()`.**
4. **–û—Ç–º–µ—Ç–∏—Ç—å —Å–¥–µ–ª–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ —è–≤–ª—è—é—Ç—Å—è –ø–æ–≤—Ç–æ—Ä—è—é—â–∏–º–∏—Å—è –ø–æ —Å—É–º–º–µ (–∏—Å–ø–æ–ª—å–∑—É—è `DENSE_RANK()`).**

## ‚úÖ 1. –ù–∞–π—Ç–∏ –¥–∞—Ç—É —Å–∞–º–æ–π –ø–µ—Ä–≤–æ–π –∏ –ø–æ—Å–ª–µ–¥–Ω–µ–π –ø—Ä–æ–¥–∞–∂–∏ –∫–∞–∂–¥–æ–≥–æ –ø—Ä–æ–¥–∞–≤—Ü–∞

```sql
SELECT DISTINCT seller,
       FIRST_VALUE(sale_date) ...,
       LAST_VALUE(sale_date) ...  AS last_sale
FROM sales;
```

üìå `DISTINCT` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –ø–æ –æ–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–µ –Ω–∞ –ø—Ä–æ–¥–∞–≤—Ü–∞.

---

## ‚úÖ 2. –ü–æ–∫–∞–∑–∞—Ç—å —Å–¥–µ–ª–∫–∏, –≥–¥–µ —Ä–∞–∑–Ω–∏—Ü–∞ —Å –ø—Ä–µ–¥—ã–¥—É—â–µ–π –ø—Ä–æ–¥–∞–∂–µ–π > 200

```sql
SELECT seller, sale_date, amount,
       .... AS diff
FROM sales
WHERE ... OVER ... > 200;
```

üìå –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `LAG()` –∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —É—Å–ª–æ–≤–∏—é.

---

## ‚úÖ 3. –ü–æ–∫–∞–∑–∞—Ç—å —Ç–æ–ø-1 –ø—Ä–æ–¥–∞–∂—É –∫–∞–∂–¥–æ–≥–æ –ø—Ä–æ–¥–∞–≤—Ü–∞ —Å `RANK()` –∏ `ROW_NUMBER()`

### üí° –í–∞—Ä–∏–∞–Ω—Ç —Å `RANK()`:

```sql
SELECT seller, amount, sale_date
FROM (
    SELECT *,
           ...
    FROM sales
) sub
WHERE rnk = 1;
```

### üí° –í–∞—Ä–∏–∞–Ω—Ç —Å `ROW_NUMBER()`:

```sql
SELECT seller, amount, sale_date
FROM (
    SELECT *,
           ... AS rn
    FROM sales
) sub
WHERE rn = 1;
```

üîé –†–∞–∑–Ω–∏—Ü–∞:

* `RANK()` –¥–æ–ø—É—Å–∫–∞–µ—Ç **–Ω–µ—Å–∫–æ–ª—å–∫–æ —Ç–æ–ø-1**, –µ—Å–ª–∏ —Å—É–º–º—ã –æ–¥–∏–Ω–∞–∫–æ–≤—ã.
* `ROW_NUMBER()` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç **—Å—Ç—Ä–æ–≥–æ –æ–¥–Ω—É —Å—Ç—Ä–æ–∫—É**, –¥–∞–∂–µ –ø—Ä–∏ –¥—É–±–ª–∏–∫–∞—Ç–∞—Ö.

---

## ‚úÖ 4. –û—Ç–º–µ—Ç–∏—Ç—å –ø–æ–≤—Ç–æ—Ä—è—é—â–∏–µ—Å—è —Å—É–º–º—ã –ø—Ä–æ–¥–∞–∂ —Å –ø–æ–º–æ—â—å—é `DENSE_RANK()`

```sql
SELECT seller, amount, sale_date,
      ...
FROM sales;
```

üìå –°–¥–µ–ª–∫–∏ —Å –æ–¥–∏–Ω–∞–∫–æ–≤–æ–π —Å—É–º–º–æ–π –ø–æ–ª—É—á–∞—Ç –æ–¥–∏–Ω–∞–∫–æ–≤—ã–π `dense_rank`. –≠—Ç–æ –ø–æ–º–æ–≥–∞–µ—Ç –≤—ã—è–≤–ª—è—Ç—å –ø–æ–≤—Ç–æ—Ä—è—é—â–∏–µ—Å—è –∑–Ω–∞—á–µ–Ω–∏—è.
