![1748584162189](image/md/1748584162189.png)


# –°–µ–∫—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ (–ø–∞—Ä—Ç–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ) —Ç–∞–±–ª–∏—Ü –≤ PostgreSQL

## –í–≤–µ–¥–µ–Ω–∏–µ
–°–µ–∫—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ (–ø–∞—Ä—Ç–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ) ‚Äî —ç—Ç–æ –º–µ—Ö–∞–Ω–∏–∑–º —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è –æ–¥–Ω–æ–π –±–æ–ª—å—à–æ–π —Ç–∞–±–ª–∏—Ü—ã –Ω–∞ –º–µ–Ω—å—à–∏–µ, –±–æ–ª–µ–µ —É–ø—Ä–∞–≤–ª—è–µ–º—ã–µ —á–∞—Å—Ç–∏, –Ω–∞–∑—ã–≤–∞–µ–º—ã–µ —Å–µ–∫—Ü–∏—è–º–∏ –∏–ª–∏ –ø–∞—Ä—Ç–∏—Ü–∏—è–º–∏. –≠—Ç–æ –º–æ—â–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å PostgreSQL, –∫–æ—Ç–æ—Ä–∞—è –ø–æ–º–æ–≥–∞–µ—Ç —É–ª—É—á—à–∏—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏ —É–ø—Ä–æ—Å—Ç–∏—Ç—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–æ–ª—å—à–∏–º–∏ –æ–±—ä–µ–º–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö.

## 1. –ó–∞–¥–∞—á–∏, —Ä–µ—à–∞–µ–º—ã–µ —Å –ø–æ–º–æ—â—å—é —Å–µ–∫—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è

### 1.1 –£–ª—É—á—à–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- **–£—Å–∫–æ—Ä–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤**: –ó–∞–ø—Ä–æ—Å—ã –º–æ–≥—É—Ç –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ –Ω—É–∂–Ω—ã–µ —Å–µ–∫—Ü–∏–∏ –±–ª–∞–≥–æ–¥–∞—Ä—è "partition pruning"
- **–ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–π –¥–æ—Å—Ç—É–ø**: –†–∞–∑–Ω—ã–µ —Å–µ–∫—Ü–∏–∏ –º–æ–≥—É—Ç –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å—Å—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ
- **–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∏–Ω–¥–µ–∫—Å–æ–≤**: –ò–Ω–¥–µ–∫—Å—ã —Å—Ç–∞–Ω–æ–≤—è—Ç—Å—è –º–µ–Ω—å—à–µ –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–µ–µ

### 1.2 –£–ø—Ä–æ—â–µ–Ω–∏–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã–º–∏
- **–£–¥–∞–ª–µ–Ω–∏–µ —Å—Ç–∞—Ä—ã—Ö –¥–∞–Ω–Ω—ã—Ö**: –ú–æ–∂–Ω–æ –±—ã—Å—Ç—Ä–æ —É–¥–∞–ª—è—Ç—å —Ü–µ–ª—ã–µ —Å–µ–∫—Ü–∏–∏ –≤–º–µ—Å—Ç–æ DELETE –ø–æ —Å—Ç—Ä–æ–∫–∞–º
- **–ê—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö**: –°—Ç–∞—Ä—ã–µ —Å–µ–∫—Ü–∏–∏ –º–æ–∂–Ω–æ –ø–µ—Ä–µ–º–µ—â–∞—Ç—å –Ω–∞ –±–æ–ª–µ–µ –º–µ–¥–ª–µ–Ω–Ω—ã–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞
- **–†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ**: –ú–æ–∂–Ω–æ –±—ç–∫–∞–ø–∏—Ç—å –æ—Ç–¥–µ–ª—å–Ω—ã–µ —Å–µ–∫—Ü–∏–∏

### 1.3 –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Ö—Ä–∞–Ω–∏–ª–∏—â–∞
- –†–∞–∑–º–µ—â–µ–Ω–∏–µ —Ä–∞–∑–Ω—ã—Ö —Å–µ–∫—Ü–∏–π –Ω–∞ —Ä–∞–∑–Ω—ã—Ö —Ñ–∏–∑–∏—á–µ—Å–∫–∏—Ö –Ω–æ—Å–∏—Ç–µ–ª—è—Ö
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–∞–∑–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Å–µ–∫—Ü–∏–π

## 2. –í–∏–¥—ã —Å–µ–∫—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –≤ PostgreSQL

### 2.1 Range Partitioning (–î–∏–∞–ø–∞–∑–æ–Ω–Ω–æ–µ —Å–µ–∫—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ)

**Range Partitioning** (–¥–∏–∞–ø–∞–∑–æ–Ω–Ω–æ–µ —Å–µ–∫—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ) ‚Äî —ç—Ç–æ —Å–ø–æ—Å–æ–± —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è —Ç–∞–±–ª–∏—Ü—ã –Ω–∞ —á–∞—Å—Ç–∏ (—Å–µ–∫—Ü–∏–∏) –ø–æ –¥–∏–∞–ø–∞–∑–æ–Ω–∞–º –∑–Ω–∞—á–µ–Ω–∏–π –æ–¥–Ω–æ–≥–æ –∏–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Å—Ç–æ–ª–±—Ü–æ–≤.

**–ü—Ä–∏–º–µ—Ä:** —Ä–∞–∑–¥–µ–ª–∏—Ç—å —Ç–∞–±–ª–∏—Ü—É –∑–∞–∫–∞–∑–æ–≤ –ø–æ –≥–æ–¥–∞–º (`order_date < 2025-01-01`, `order_date >= 2025-01-01 AND < 2023-01-01` –∏ —Ç.–¥.).

### –ó–∞—á–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Partitioning?

* üìà –ü–æ–≤—ã—à–∞–µ—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∑–∞–ø—Ä–æ—Å–æ–≤ (–æ—Å–æ–±–µ–Ω–Ω–æ —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π).
* üìâ –£–º–µ–Ω—å—à–∞–µ—Ç –Ω–∞–≥—Ä—É–∑–∫—É –Ω–∞ –∏–Ω–¥–µ–∫—Å—ã.
* üßπ –£–ø—Ä–æ—â–∞–µ—Ç –∞—Ä—Ö–∏–≤–∞—Ü–∏—é –∏ —É–¥–∞–ª–µ–Ω–∏–µ —Å—Ç–∞—Ä—ã—Ö –¥–∞–Ω–Ω—ã—Ö.

–û—Ç–ª–∏—á–Ω–æ, –≤—ã —Ö–æ—Ç–∏—Ç–µ –ø—Ä–∏–º–µ—Ä —Å–µ–∫—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è **–±–µ–∑ `PRIMARY KEY`** –Ω–∞ —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–π —Ç–∞–±–ª–∏—Ü–µ. –≠—Ç–æ –¥–æ–ø—É—Å—Ç–∏–º–æ –∏ –¥–∞–∂–µ —É–¥–æ–±–Ω–æ –≤ —Å–ª—É—á–∞—è—Ö, –∫–æ–≥–¥–∞:

* –£–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å `id` –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è –≥–ª–æ–±–∞–ª—å–Ω–æ
* –í—ã —Ö–æ—Ç–∏—Ç–µ —Å–æ–∑–¥–∞–≤–∞—Ç—å —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∫–ª—é—á–∏ –Ω–∞ **–æ—Ç–¥–µ–ª—å–Ω—ã—Ö –ø–∞—Ä—Ç–∏—Ü–∏—è—Ö**
* –ò–ª–∏ –æ–±–æ–π—Ç–∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ, —Å–≤—è–∑–∞–Ω–Ω–æ–µ —Å –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–º –≤–∫–ª—é—á–µ–Ω–∏–µ–º —Å–µ–∫—Ü–∏–æ–Ω–∏—Ä—É—é—â–µ–≥–æ —Å—Ç–æ–ª–±—Ü–∞ –≤ –∫–ª—é—á

---

## üìò –£—Ä–æ–∫: Range Partitioning –±–µ–∑ `PRIMARY KEY` –≤ PostgreSQL 16

### ‚úÖ –®–∞–≥ 1: –°–æ–∑–¥–∞—ë–º —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫—É—é —Ç–∞–±–ª–∏—Ü—É

```sql
CREATE TABLE orders (
    id int,
    customer_name text,
    order_date date NOT NULL
) PARTITION BY RANGE (order_date);
```

> ‚ùó –ó–¥–µ—Å—å **–Ω–µ—Ç `PRIMARY KEY`** ‚Äî —ç—Ç–æ –¥–æ–ø—É—Å—Ç–∏–º–æ, –Ω–æ –∑–Ω–∞—á–∏—Ç, —á—Ç–æ PostgreSQL **–Ω–µ –±—É–¥–µ—Ç –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä–æ–≤–∞—Ç—å —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å `id` –∏–ª–∏ –¥—Ä—É–≥–∏—Ö –ø–æ–ª–µ–π** –Ω–∞ —É—Ä–æ–≤–Ω–µ –≤—Å–µ–π —Ç–∞–±–ª–∏—Ü—ã.

---

### ‚úÖ –®–∞–≥ 2: –°–æ–∑–¥–∞–Ω–∏–µ –ø–∞—Ä—Ç–∏—Ü–∏–π

```sql
CREATE TABLE orders_2022 PARTITION OF orders
    FOR VALUES FROM ('2022-01-01') TO ('2023-01-01');

CREATE TABLE orders_2023 PARTITION OF orders
    FOR VALUES FROM ('2023-01-01') TO ('2024-01-01');

CREATE TABLE orders_2024 PARTITION OF orders
    FOR VALUES FROM ('2024-01-01') TO ('2025-01-01');
```

---

---

### ‚úÖ –®–∞–≥ 3: –í—Å—Ç–∞–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö

```sql
INSERT INTO orders (id, customer_name, order_date)
VALUES
  (1, '–ò–≤–∞–Ω–æ–≤', '2022-06-01'),
  (2, '–ü–µ—Ç—Ä–æ–≤', '2023-08-15'),
  (3, '–°–∏–¥–æ—Ä–æ–≤', '2024-01-10');
```

---

### ‚úÖ –®–∞–≥ 4: –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—ã–±–æ—Ä–∫–∏ –∏ –ø–ª–∞–Ω–∞

```sql
EXPLAIN ANALYZE
SELECT * FROM orders WHERE order_date >= '2023-01-01' AND order_date < '2024-01-01';
```

–û–∂–∏–¥–∞–µ–º: **Partition Pruning** ‚Äî —Ç–æ–ª—å–∫–æ –Ω—É–∂–Ω–∞—è –ø–∞—Ä—Ç–∏—Ü–∏—è –±—É–¥–µ—Ç —É—á–∞—Å—Ç–≤–æ–≤–∞—Ç—å.

---



# üìò –ü—Ä–∞–∫—Ç–∏–∫–∞: Range Partitioning –≤ PostgreSQL 16

## ‚úÖ –ó–∞–¥–∞–Ω–∏–µ 1: –î–æ–±–∞–≤–∏—Ç—å –ø–∞—Ä—Ç–∏—Ü–∏—é –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é

**–¶–µ–ª—å:** –æ–±—Ä–∞–±–æ—Ç–∫–∞ "–≤—ã–ø–∞–¥–∞—é—â–∏—Ö" –¥–∞—Ç

```sql
CREATE TABLE orders_default PARTITION OF orders DEFAULT;
```

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**

```sql
INSERT INTO orders VALUES (100, '–ê–ª–µ–∫—Å–µ–µ–≤', '2025-06-01');
SELECT * FROM orders_default;
```

üß† *–û–±—ä—è—Å–Ω–µ–Ω–∏–µ:* `DEFAULT`-–ø–∞—Ä—Ç–∏—Ü–∏—è –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –≤—Å–µ –∑–Ω–∞—á–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –ø–æ–ø–∞–ª–∏ –Ω–∏ –≤ –æ–¥–Ω—É –¥—Ä—É–≥—É—é.

---

## ‚úÖ –ó–∞–¥–∞–Ω–∏–µ 2: –ò–Ω–¥–µ–∫—Å –ø–æ `customer_name` –≤ –∫–∞–∂–¥–æ–π –ø–∞—Ä—Ç–∏—Ü–∏–∏

**–¶–µ–ª—å:** —É—Å–∫–æ—Ä–∏—Ç—å –ø–æ–∏—Å–∫ –ø–æ –∏–º–µ–Ω–∏

```sql
CREATE INDEX ON orders_2022 (customer_name);
CREATE INDEX ON orders_2023 (customer_name);
CREATE INDEX ON orders_2024 (customer_name);
```

**–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:**

```sql
EXPLAIN ANALYZE
SELECT * FROM orders WHERE customer_name = '–ò–≤–∞–Ω–æ–≤';
```

üß† *–û–±—ä—è—Å–Ω–µ–Ω–∏–µ:* –∏–Ω–¥–µ–∫—Å—ã –Ω—É–∂–Ω–æ —Å–æ–∑–¥–∞–≤–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω–æ –¥–ª—è –∫–∞–∂–¥–æ–π –ø–∞—Ä—Ç–∏—Ü–∏–∏ ‚Äî –≥–ª–æ–±–∞–ª—å–Ω—ã—Ö –∏–Ω–¥–µ–∫—Å–æ–≤ –Ω–µ—Ç.

---

## ‚úÖ –ó–∞–¥–∞–Ω–∏–µ 3: –£–¥–∞–ª–∏—Ç—å –≤—Å–µ –∑–∞–∫–∞–∑—ã 2022 –≥–æ–¥–∞

```sql
DROP TABLE orders_2022;
```

üß† *–û–±—ä—è—Å–Ω–µ–Ω–∏–µ:* —ç—Ç–æ –±–µ–∑–æ–ø–∞—Å–Ω—ã–π –∏ –±—ã—Å—Ç—Ä—ã–π —Å–ø–æ—Å–æ–± —É–¥–∞–ª–∏—Ç—å –ø–∞—Ä—Ç–∏—Ü–∏—é —Ü–µ–ª–∏–∫–æ–º ‚Äî –Ω–∞–º–Ω–æ–≥–æ –±—ã—Å—Ç—Ä–µ–µ, —á–µ–º `DELETE`.

---

## ‚úÖ –ó–∞–¥–∞–Ω–∏–µ 4: –ü—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ `orders_summary`

**–¶–µ–ª—å:** –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤ –ø–æ –≥–æ–¥–∞–º

```sql
CREATE VIEW orders_summary AS
SELECT
    EXTRACT(YEAR FROM order_date) AS year,
    COUNT(*) AS total_orders
FROM orders
GROUP BY 1
ORDER BY 1;
```

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**

```sql
SELECT * FROM orders_summary;
```

üß† *–û–±—ä—è—Å–Ω–µ–Ω–∏–µ:* –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –∞–≥—Ä–µ–≥–∏—Ä—É–µ—Ç –ø–æ –¥–∞—Ç–µ –∏–∑ –≤—Å–µ—Ö –ø–∞—Ä—Ç–∏—Ü–∏–π ‚Äî PostgreSQL —Å–∞–º –æ–±—Ö–æ–¥–∏—Ç –∏—Ö.

---

## ‚úÖ –ó–∞–¥–∞–Ω–∏–µ 5: –û–±–Ω–æ–≤–∏—Ç—å –∫–ª–∏–µ–Ω—Ç–∞ `'–ò–≤–∞–Ω–æ–≤'` –Ω–∞ `'–ò–≤–∞–Ω–æ–≤ –ò.–ò.'`

```sql
UPDATE orders
SET customer_name = '–ò–≤–∞–Ω–æ–≤ –ò.–ò.'
WHERE customer_name = '–ò–≤–∞–Ω–æ–≤';
```

üß† *–û–±—ä—è—Å–Ω–µ–Ω–∏–µ:* –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –≤–Ω—É—Ç—Ä–∏ –∫–∞–∂–¥–æ–π –ø–∞—Ä—Ç–∏—Ü–∏–∏, –≥–¥–µ –µ—Å—Ç—å —Ç–∞–∫–∏–µ —Å—Ç—Ä–æ–∫–∏. PostgreSQL –ø—Ä–∏–º–µ–Ω—è–µ—Ç **partition-wise UPDATE** –ø—Ä–∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏.

---



## ‚úÖ –ó–∞–¥–∞–Ω–∏–µ 6: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `MERGE`


```sql
MERGE INTO orders AS o
USING (VALUES
    (2, '–ü–µ—Ç—Ä–æ–≤ –ü.–ü.', DATE '2023-01-12'),
    (4, '–°–º–∏—Ä–Ω–æ–≤',     DATE '2023-01-13')
) AS incoming(id, customer_name, order_date)
ON o.id = incoming.id
WHEN MATCHED THEN
    UPDATE SET customer_name = incoming.customer_name
WHEN NOT MATCHED THEN
    INSERT (id, customer_name, order_date)
    VALUES (incoming.id, incoming.customer_name, incoming.order_date);

```


```sql
MERGE INTO orders AS o
USING (VALUES (4, '–°–º–∏—Ä–Ω–æ–≤', '2023-04-10')) AS v(id, name, date)
ON o.id = v.id AND o.order_date = v.date
WHEN MATCHED THEN
    UPDATE SET customer_name = v.name
WHEN NOT MATCHED THEN
    INSERT VALUES (v.id, v.name, v.date);
```

üß† *–û–±—ä—è—Å–Ω–µ–Ω–∏–µ:* `MERGE` –≤—ã–ø–æ–ª–Ω—è–µ—Ç UPSERT –Ω–∞ —Å–µ–∫—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Ç–∞–±–ª–∏—Ü–µ. PostgreSQL 16 –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —ç—Ç–æ.

---

## ‚úÖ –ó–∞–¥–∞–Ω–∏–µ 7: –£–∑–Ω–∞—Ç—å, –≤ –∫–∞–∫–æ–π –ø–∞—Ä—Ç–∏—Ü–∏–∏ –∑–∞–∫–∞–∑

```sql
SELECT id, customer_name, order_date, tableoid::regclass AS partition
FROM orders
WHERE id = 4;
```

üß† *–û–±—ä—è—Å–Ω–µ–Ω–∏–µ:* `tableoid::regclass` –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –∏–º—è –ø–∞—Ä—Ç–∏—Ü–∏–∏, –≤ –∫–æ—Ç–æ—Ä–æ–π —Ö—Ä–∞–Ω–∏—Ç—Å—è —Å—Ç—Ä–æ–∫–∞.

---


## ‚úÖ –ó–∞–¥–∞–Ω–∏–µ 7: üéì –ú–∞—Ç–µ—Ä–∏–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è –≤ PostgreSQL


**–ú–∞—Ç–µ—Ä–∏–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ (Materialized View)** ‚Äî —ç—Ç–æ –æ–±—ä–µ–∫—Ç –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö, –∫–æ—Ç–æ—Ä—ã–π —Ö—Ä–∞–Ω–∏—Ç **—Ä–µ–∑—É–ª—å—Ç–∞—Ç SQL-–∑–∞–ø—Ä–æ—Å–∞ —Ñ–∏–∑–∏—á–µ—Å–∫–∏**, –≤ –æ—Ç–ª–∏—á–∏–µ –æ—Ç –æ–±—ã—á–Ω—ã—Ö –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–π (`VIEW`), –∫–æ—Ç–æ—Ä—ã–µ —Ñ–æ—Ä–º–∏—Ä—É—é—Ç—Å—è –Ω–∞ –ª–µ—Ç—É.

```sql

CREATE MATERIALIZED VIEW monthly_sales AS
SELECT
    DATE_TRUNC('month', order_date) AS month,
    count(customer_name) AS total_customer
FROM orders
GROUP BY month
ORDER BY month;

SELECT * FROM monthly_sales;

INSERT INTO orders (customer_name, order_date)
VALUES ('–¢–µ—Å—Ç–æ–≤', '2024-02-10');

INSERT INTO orders (customer_name, order_date)
VALUES ('–¢–µ—Å—Ç–æ–≤-2', '2024-02-10');


REFRESH MATERIALIZED VIEW monthly_sales;

```


---

## ‚úÖ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:

* –£—Å–∫–æ—Ä—è–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Å–ª–æ–∂–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤.
* –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –æ—Ç—á–µ—Ç–æ–≤, –¥–∞—à–±–æ—Ä–¥–æ–≤ –∏ –∞–≥—Ä–µ–≥–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö.

## ‚ö†Ô∏è –ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏:

* –î–∞–Ω–Ω—ã–µ **–Ω–µ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏**, –∏—Ö –Ω—É–∂–Ω–æ **–æ–±–Ω–æ–≤–ª—è—Ç—å –≤—Ä—É—á–Ω—É—é**.
* –ó–∞–Ω–∏–º–∞—é—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ –º–µ—Å—Ç–æ –Ω–∞ –¥–∏—Å–∫–µ.

---

## üîß –°–∏–Ω—Ç–∞–∫—Å–∏—Å

```sql
CREATE MATERIALIZED VIEW –∏–º—è_–ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è AS
SELECT ...
WITH [NO] DATA;
```

* `WITH DATA` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é) ‚Äî —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Å—Ä–∞–∑—É.
* `WITH NO DATA` ‚Äî —Å–æ–∑–¥–∞–µ—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ, –Ω–æ –±–µ–∑ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è.

–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö:

```sql
REFRESH MATERIALIZED VIEW –∏–º—è_–ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è;
```



## üß† –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

| –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤                 | –° `PRIMARY KEY`    | –ë–µ–∑ `PRIMARY KEY`       |
| ----------------------------------- | ------------------ | ----------------------- |
| –ü—Ä–æ–≤–µ—Ä–∫–∞ —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç–∏               | –ì–ª–æ–±–∞–ª—å–Ω–∞—è (–≤–µ–∑–¥–µ) | –¢–æ–ª—å–∫–æ –≤—Ä—É—á–Ω—É—é/–ª–æ–∫–∞–ª—å–Ω–æ |
| –ù–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å –≤–∫–ª—é—á–∞—Ç—å `order_date` | –î–∞                 | –ù–µ—Ç                     |
| –ü—Ä–æ—Å—Ç–æ—Ç–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏                 | –ß—É—Ç—å —Å–ª–æ–∂–Ω–µ–µ       | –ü—Ä–æ—â–µ                   |

---





### 2.2 List Partitioning (–°–ø–∏—Å–æ—á–Ω–æ–µ —Å–µ–∫—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ)

**List Partitioning** ‚Äî —ç—Ç–æ —Å–ø–æ—Å–æ–± —Ä–∞–∑–¥–µ–ª–∏—Ç—å —Ç–∞–±–ª–∏—Ü—É –Ω–∞ —á–∞—Å—Ç–∏ (–ø–∞—Ä—Ç–∏—Ü–∏–∏), –≥–¥–µ –∫–∞–∂–¥–∞—è –ø–∞—Ä—Ç–∏—Ü–∏—è —Å–æ–¥–µ—Ä–∂–∏—Ç —Å—Ç—Ä–æ–∫–∏ —Å **–∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º –∑–Ω–∞—á–µ–Ω–∏–µ–º** –æ–¥–Ω–æ–≥–æ –∏–∑ —Å—Ç–æ–ª–±—Ü–æ–≤.
–ù–∞–ø—Ä–∏–º–µ—Ä, –º–æ–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω—ã–µ –ø–∞—Ä—Ç–∏—Ü–∏–∏ –ø–æ —Å—Ç—Ä–∞–Ω–∞–º, —Ä–µ–≥–∏–æ–Ω–∞–º, —Å—Ç–∞—Ç—É—Å–∞–º –∏ —Ç.–¥.

---

## üì¶ –ü—Ä–∏–º–µ—Ä: –°–µ–∫—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–∫–∞–∑–æ–≤ –ø–æ —Å—Ç–∞—Ç—É—Å—É

---

### 1. –°–æ–∑–¥–∞—ë–º —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫—É—é —Ç–∞–±–ª–∏—Ü—É

```sql
CREATE TABLE orders (
    id serial,
    customer_name text,
    status text NOT NULL
) PARTITION BY LIST (status);
```

---

### 2. –°–æ–∑–¥–∞—ë–º –ø–∞—Ä—Ç–∏—Ü–∏–∏

```sql
CREATE TABLE orders_new PARTITION OF orders
    FOR VALUES IN ('new');

CREATE TABLE orders_processing PARTITION OF orders
    FOR VALUES IN ('processing');

CREATE TABLE orders_done PARTITION OF orders
    FOR VALUES IN ('done');
```

---

### 3. (–ù–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ) –ü–∞—Ä—Ç–∏—Ü–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é

```sql
CREATE TABLE orders_other PARTITION OF orders DEFAULT;
```

üß† –≠—Ç–∞ –ø–∞—Ä—Ç–∏—Ü–∏—è –±—É–¥–µ—Ç –ø—Ä–∏–Ω–∏–º–∞—Ç—å —Å—Ç—Ä–æ–∫–∏ —Å –ª—é–±—ã–º —Å—Ç–∞—Ç—É—Å–æ–º, –Ω–µ —É–∫–∞–∑–∞–Ω–Ω—ã–º –≤ –¥—Ä—É–≥–∏—Ö –ø–∞—Ä—Ç–∏—Ü–∏—è—Ö.

---

### 4. –í—Å—Ç–∞–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö

```sql
INSERT INTO orders (customer_name, status) VALUES
('–ò–≤–∞–Ω–æ–≤', 'new'),
('–ü–µ—Ç—Ä–æ–≤', 'processing'),
('–°–∏–¥–æ—Ä–æ–≤', 'done'),
('–ú–∏—Ö–∞–π–ª–æ–≤', 'canceled');  -- –ø–æ–ø–∞–¥—ë—Ç –≤ orders_other
```

---

### 5. –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞–Ω–Ω—ã—Ö

```sql
SELECT * FROM orders_new;
SELECT * FROM orders_other;
```

---

## üß† –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç?

* PostgreSQL —Å–∞–º –Ω–∞–ø—Ä–∞–≤–ª—è–µ—Ç —Å—Ç—Ä–æ–∫—É –≤ –Ω—É–∂–Ω—É—é –ø–∞—Ä—Ç–∏—Ü–∏—é
* –ó–∞–ø—Ä–æ—Å—ã –∫ `orders` –ø—Ä–æ–∑—Ä–∞—á–Ω–æ —Ä–∞–±–æ—Ç–∞—é—Ç —Å –ø–∞—Ä—Ç–∏—Ü–∏—è–º–∏
* –ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **partition pruning** ‚Äî –µ—Å–ª–∏ –≤ WHERE –µ—Å—Ç—å `status`, Postgres –æ–±–æ–π–¥—ë—Ç —Ç–æ–ª—å–∫–æ –Ω—É–∂–Ω—ã–µ –ø–∞—Ä—Ç–∏—Ü–∏–∏

---

## üîç EXPLAIN: –ø—Ä–æ–≤–µ—Ä–∫–∞ pruning

```sql
EXPLAIN SELECT * FROM orders WHERE status = 'processing';
```

‚úÖ –í –ø–ª–∞–Ω–µ –±—É–¥–µ—Ç –≤–∏–¥–Ω–æ, —á—Ç–æ —á–∏—Ç–∞–µ—Ç—Å—è **—Ç–æ–ª—å–∫–æ –Ω—É–∂–Ω–∞—è –ø–∞—Ä—Ç–∏—Ü–∏—è** (`orders_processing`).

---

## ‚úÖ –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –∑–∞–¥–∞—á–∏

### –ó–∞–¥–∞–Ω–∏–µ 1: –î–æ–±–∞–≤–∏—Ç—å –µ—â—ë –æ–¥–Ω—É –ø–∞—Ä—Ç–∏—Ü–∏—é

–°–æ–∑–¥–∞–π –ø–∞—Ä—Ç–∏—Ü–∏—é `orders_canceled` –¥–ª—è —Å—Ç–∞—Ç—É—Å–∞ `'canceled'`.

```sql
CREATE TABLE orders_canceled PARTITION OF orders
    FOR VALUES IN ('canceled');
```

---

### –ó–∞–¥–∞–Ω–∏–µ 2: –ù–∞–π—Ç–∏, –≤ –∫–∞–∫–æ–π –ø–∞—Ä—Ç–∏—Ü–∏–∏ –∑–∞–∫–∞–∑

```sql
SELECT id, customer_name, status, tableoid::regclass AS partition
FROM orders;
```

---

### –ó–∞–¥–∞–Ω–∏–µ 3: –£–¥–∞–ª–∏—Ç—å —Å—Ç—Ä–æ–∫–∏ —Å `status = 'done'`

```sql
DELETE FROM orders WHERE status = 'done';
```

üß† –í—ã–ø–æ–ª–Ω–∏—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤ `orders_done`.

---

### –ó–∞–¥–∞–Ω–∏–µ 4: –£–¥–∞–ª–∏—Ç—å –ø–∞—Ä—Ç–∏—Ü–∏—é `orders_other`

```sql
DROP TABLE orders_other;
```

---

## ‚ö†Ô∏è –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –∏ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

* –í—Å–µ `UNIQUE` –∏ `PRIMARY KEY` –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –¥–æ–ª–∂–Ω—ã –≤–∫–ª—é—á–∞—Ç—å —Å–µ–∫—Ü–∏–æ–Ω–∏—Ä—É—é—â–∏–π —Å—Ç–æ–ª–±–µ—Ü (`status`)
* –ù–µ—Ç –≥–ª–æ–±–∞–ª—å–Ω—ã—Ö –∏–Ω–¥–µ–∫—Å–æ–≤ ‚Äî –Ω—É–∂–Ω–æ —Å–æ–∑–¥–∞–≤–∞—Ç—å –∏–Ω–¥–µ–∫—Å—ã **–≤ –∫–∞–∂–¥–æ–π –ø–∞—Ä—Ç–∏—Ü–∏–∏**
* –ù–µ–ª—å–∑—è –≤—Å—Ç–∞–≤–∏—Ç—å —Å—Ç—Ä–æ–∫—É —Å `status`, –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–º –Ω–∏ –æ–¥–Ω–æ–π –ø–∞—Ä—Ç–∏—Ü–∏–∏, –µ—Å–ª–∏ –Ω–µ—Ç `DEFAULT`-–ø–∞—Ä—Ç–∏—Ü–∏–∏ ‚Äî –ø–æ–ª—É—á–∏—Ç–µ –æ—à–∏–±–∫—É

---

## üìå –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

List Partitioning —É–¥–æ–±–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å, –µ—Å–ª–∏:

* –£ –≤–∞—Å –µ—Å—Ç—å —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫ –∑–Ω–∞—á–µ–Ω–∏–π (`'new'`, `'done'`, `'processing'`, ‚Ä¶)
* –î–∞–Ω–Ω—ã–µ –ª–æ–≥–∏—á–µ—Å–∫–∏ —Ö–æ—Ä–æ—à–æ –≥—Ä—É–ø–ø–∏—Ä—É—é—Ç—Å—è –ø–æ —ç—Ç–∏–º –∑–Ω–∞—á–µ–Ω–∏—è–º
* –í—ã —Ö–æ—Ç–∏—Ç–µ —É–ø—Ä–æ—Å—Ç–∏—Ç—å –æ—á–∏—Å—Ç–∫—É/–∞—Ä—Ö–∏–≤–∞—Ü–∏—é –¥–∞–Ω–Ω—ã—Ö (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø—Ä–æ—Å—Ç–æ —É–¥–∞–ª–∏—Ç—å –ø–∞—Ä—Ç–∏—Ü–∏—é)



### 2.4 –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –º–µ—Ç–æ–¥—ã
PostgreSQL –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –º–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤–æ–µ —Å–µ–∫—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ (–ø–æ–¥—Å–µ–∫—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ).
–í PostgreSQL 16 —Å–µ–∫—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç–∞–ª–æ –±–æ–ª–µ–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω—ã–º –∏ —É–¥–æ–±–Ω—ã–º, –Ω–æ **–æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ —Å–µ–∫—Ü–∏–π (–ø–∞—Ä—Ç–∏—Ü–∏–π)** –≤—Å—ë –µ—â—ë —Ç—Ä–µ–±—É–µ—Ç –≤–Ω–∏–º–∞–Ω–∏—è. –í–æ—Ç –ø–æ–¥—Ä–æ–±–Ω—ã–π —Ä–∞–∑–±–æ—Ä:

---

# üõ† –û–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ —Å–µ–∫—Ü–∏–π (–ø–∞—Ä—Ç–∏—Ü–∏–π) –≤ PostgreSQL 16

---

## üîπ 1. –ó–∞—á–µ–º –æ–±—Å–ª—É–∂–∏–≤–∞—Ç—å –ø–∞—Ä—Ç–∏—Ü–∏–∏?

–ü–∞—Ä—Ç–∏—Ü–∏–∏ ‚Äî —ç—Ç–æ –æ–±—ã—á–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã –ø–æ–¥ –∫–∞–ø–æ—Ç–æ–º. –û–Ω–∏ –Ω—É–∂–¥–∞—é—Ç—Å—è –≤:

* **–∞—Ä—Ö–∏–≤–∞—Ü–∏–∏** –∏–ª–∏ **—É–¥–∞–ª–µ–Ω–∏–∏ —É—Å—Ç–∞—Ä–µ–≤—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö**
* **–ø–µ—Ä–µ–∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏** –∏ **–∞–Ω–∞–ª–∏–∑–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏**
* **–¥–æ–±–∞–≤–ª–µ–Ω–∏–∏/—É–¥–∞–ª–µ–Ω–∏–∏** –ø–∞—Ä—Ç–∏—Ü–∏–π –ø–æ –º–µ—Ä–µ —Ä–æ—Å—Ç–∞ –¥–∞–Ω–Ω—ã—Ö
* **–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–µ** –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

---

## üîπ 2. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏

```sql
ANALYZE orders;
```

üîç –í—ã–ø–æ–ª–Ω—è–µ—Ç `ANALYZE` –Ω–∞ –≤—Å–µ—Ö –¥–æ—á–µ—Ä–Ω–∏—Ö —Ç–∞–±–ª–∏—Ü–∞—Ö. –ú–æ–∂–Ω–æ –æ—Ç–¥–µ–ª—å–Ω–æ:

```sql
ANALYZE orders_2023;
```

---

## üîπ 3. –ò–Ω–¥–µ–∫—Å–∞—Ü–∏—è

–ò–Ω–¥–µ–∫—Å—ã –Ω—É–∂–Ω–æ —Å–æ–∑–¥–∞–≤–∞—Ç—å **–Ω–∞ –∫–∞–∂–¥–æ–π –ø–∞—Ä—Ç–∏—Ü–∏–∏ –æ—Ç–¥–µ–ª—å–Ω–æ**:

```sql
CREATE INDEX ON orders_2022 (customer_name);
```

üí° –í PostgreSQL 16 –ø–æ–∫–∞ **–Ω–µ—Ç –≥–ª–æ–±–∞–ª—å–Ω—ã—Ö –∏–Ω–¥–µ–∫—Å–æ–≤**, –∫–∞–∫ –≤ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –¥—Ä—É–≥–∏—Ö –°–£–ë–î.

---

## üîπ 4. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Å—Ç—Ä–æ–∫

```sql
SELECT
    relname AS partition,
    reltuples::bigint AS estimated_rows
FROM pg_class
WHERE relname LIKE 'orders_%';
```

---

## üîπ 5. –û—á–∏—Å—Ç–∫–∞/—É–¥–∞–ª–µ–Ω–∏–µ —É—Å—Ç–∞—Ä–µ–≤—à–∏—Ö –ø–∞—Ä—Ç–∏—Ü–∏–π

–£–¥–∞–ª–µ–Ω–∏–µ –ø–∞—Ä—Ç–∏—Ü–∏–∏ ‚Äî –æ—á–µ–Ω—å –±—ã—Å—Ç—Ä–æ:

```sql
DROP TABLE orders_2022;
```

üìå –≠—Ç–æ –Ω–∞–º–Ω–æ–≥–æ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–µ–µ, —á–µ–º `DELETE FROM`.

---

## üîπ 6. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –ø–∞—Ä—Ç–∏—Ü–∏–π

–ü—Ä–∏–º–µ—Ä:

```sql
CREATE TABLE orders_2025 PARTITION OF orders
    FOR VALUES FROM ('2025-01-01') TO ('2026-01-01');
```

üí° –û–±—ã—á–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **—Å–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏**, –∫–æ—Ç–æ—Ä—ã–π –¥–æ–±–∞–≤–ª—è–µ—Ç –Ω–æ–≤—ã–µ –ø–∞—Ä—Ç–∏—Ü–∏–∏ –≤ –Ω–∞—á–∞–ª–µ –º–µ—Å—è—Ü–∞/–≥–æ–¥–∞.

---

## üîπ 7. –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è "–≤—ã–ø–∞–¥–∞—é—â–∏—Ö" —Å—Ç—Ä–æ–∫

–ï—Å–ª–∏ –≤—ã –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ `DEFAULT`-–ø–∞—Ä—Ç–∏—Ü–∏—é, —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—Å–µ –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ–ø–∞–¥–∞—é—Ç –≤ –¥–∏–∞–ø–∞–∑–æ–Ω—ã:

```sql
-- –ø—Ä–∏–º–µ—Ä –¥–ª—è RANGE —Å–µ–∫—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
SELECT * FROM orders
WHERE order_date < '2022-01-01' OR order_date >= '2025-01-01';
```

---

## üîπ 8. –ü—Ä–æ–≤–µ—Ä–∫–∞, –∫–∞–∫–∞—è –ø–∞—Ä—Ç–∏—Ü–∏—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è

```sql
SELECT id, tableoid::regclass AS partition
FROM orders
LIMIT 10;
```

---

## üîπ 9. VACUUM –ø–æ –ø–∞—Ä—Ç–∏—Ü–∏—è–º

```sql
VACUUM ANALYZE orders_2023;
```

–ú–æ–∂–Ω–æ –Ω–∞–ø–∏—Å–∞—Ç—å —Å–∫—Ä–∏–ø—Ç, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–æ–±–µ–≥–∞–µ—Ç—Å—è –ø–æ –≤—Å–µ–º –ø–∞—Ä—Ç–∏—Ü–∏—è–º.

---

## üîπ 10. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ partition pruning

–ü—Ä–æ–≤–µ—Ä–∫–∞, –Ω–∞—Å–∫–æ–ª—å–∫–æ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ Postgres –æ—Ç—Å–µ–∫–∞–µ—Ç –Ω–µ–Ω—É–∂–Ω—ã–µ –ø–∞—Ä—Ç–∏—Ü–∏–∏:

```sql
EXPLAIN ANALYZE
SELECT * FROM orders WHERE order_date = '2023-05-01';
```

‚è± –ï—Å–ª–∏ pruning —Ä–∞–±–æ—Ç–∞–µ—Ç, Postgres —Å—Å—ã–ª–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –Ω–∞ –Ω—É–∂–Ω—É—é –ø–∞—Ä—Ç–∏—Ü–∏—é (`orders_2023`).


